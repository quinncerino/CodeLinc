<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BenefitLink - Benefits Assistant</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: system-ui, -apple-system, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { background: white; padding: 2rem; border-radius: 15px; text-align: center; margin-bottom: 2rem; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .header h1 { color: #667eea; font-size: 2.5rem; margin-bottom: 0.5rem; }
        .card { background: white; border-radius: 15px; padding: 2rem; margin-bottom: 1.5rem; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; }
        .form-group { margin-bottom: 1rem; }
        label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: #333; }
        input, select, textarea { width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #667eea; }
        .checkbox-group { display: flex; flex-wrap: wrap; gap: 1rem; }
        .checkbox-item { display: flex; align-items: center; gap: 0.5rem; }
        .btn { background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 16px; }
        .btn:hover { opacity: 0.9; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .result { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 2rem; border-radius: 15px; margin-top: 1rem; }
        .loading { text-align: center; padding: 2rem; }
        .spinner { border: 4px solid #f3f3f3; border-top: 4px solid #667eea; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        textarea { min-height: 100px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function App() {
            const [age, setAge] = useState(30);
            const [income, setIncome] = useState(50000);
            const [familyStatus, setFamilyStatus] = useState('Single');
            const [dependents, setDependents] = useState(0);
            const [benefits, setBenefits] = useState([]);
            const [question, setQuestion] = useState('');
            const [result, setResult] = useState('');
            const [loading, setLoading] = useState(false);

            const benefitOptions = ['Dental', 'Vision', 'Employee Assistance Program', 'Caregiver Resources'];

            const toggleBenefit = (benefit) => {
                setBenefits(prev => 
                    prev.includes(benefit) ? prev.filter(b => b !== benefit) : [...prev, benefit]
                );
            };

            const callAPI = async (question) => {
                setLoading(true);
                try {
                    const response = await fetch('http://localhost:5000/api/advice', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ question })
                    });
                    const data = await response.json();
                    if (data.success) {
                        setResult(data.answer);
                    } else {
                        setResult('Error: ' + data.error);
                    }
                } catch (error) {
                    setResult('Error connecting to server. Make sure api.py is running.');
                } finally {
                    setLoading(false);
                }
            };

            const getRecommendations = () => {
                if (!benefits.length) {
                    alert('Please select at least one benefit');
                    return;
                }
                const profile = `Age: ${age}, Income: $${income}, Family: ${familyStatus}, Dependents: ${dependents}`;
                const q = `Recommend optimal benefits for: ${profile}. Focus on: ${benefits.join(', ')}`;
                callAPI(q);
            };

            const askQuestion = () => {
                if (!question) return;
                callAPI(question);
            };

            return (
                <div className="container">
                    <div className="header">
                        <h1>ðŸ’¼ BenefitLink</h1>
                        <p>Your Intelligent Benefits Selection Assistant</p>
                    </div>

                    <div className="card">
                        <h2>Personal Information</h2>
                        <div className="form-row">
                            <div className="form-group">
                                <label>Age</label>
                                <input type="number" value={age} onChange={(e) => setAge(e.target.value)} min="18" max="100" />
                            </div>
                            <div className="form-group">
                                <label>Annual Income ($)</label>
                                <input type="number" value={income} onChange={(e) => setIncome(e.target.value)} min="0" step="5000" />
                            </div>
                        </div>
                        <div className="form-row">
                            <div className="form-group">
                                <label>Family Status</label>
                                <select value={familyStatus} onChange={(e) => setFamilyStatus(e.target.value)}>
                                    <option>Single</option>
                                    <option>Married</option>
                                    <option>Married with children</option>
                                    <option>Single parent</option>
                                </select>
                            </div>
                            <div className="form-group">
                                <label>Number of Dependents</label>
                                <input type="number" value={dependents} onChange={(e) => setDependents(e.target.value)} min="0" max="10" />
                            </div>
                        </div>
                    </div>

                    <div className="card">
                        <h2>Select Benefits</h2>
                        <div className="checkbox-group">
                            {benefitOptions.map(benefit => (
                                <div key={benefit} className="checkbox-item">
                                    <input 
                                        type="checkbox" 
                                        checked={benefits.includes(benefit)}
                                        onChange={() => toggleBenefit(benefit)}
                                    />
                                    <label>{benefit}</label>
                                </div>
                            ))}
                        </div>
                        <button className="btn" onClick={getRecommendations} disabled={loading} style={{marginTop: '1rem'}}>
                            Get Personalized Recommendations
                        </button>
                    </div>

                    <div className="card">
                        <h2>Ask a Question</h2>
                        <textarea 
                            value={question} 
                            onChange={(e) => setQuestion(e.target.value)}
                            placeholder="e.g., What dental coverage is available?"
                        />
                        <button className="btn" onClick={askQuestion} disabled={loading} style={{marginTop: '1rem'}}>
                            Get Answer
                        </button>
                    </div>

                    {loading && (
                        <div className="loading">
                            <div className="spinner"></div>
                            <p>Analyzing...</p>
                        </div>
                    )}

                    {result && !loading && (
                        <div className="result">
                            <h2>Results</h2>
                            <p>{result}</p>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>